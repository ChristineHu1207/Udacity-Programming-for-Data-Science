1
00:00:00,190 --> 00:00:04,310
والآن بعد أن نتناول استعلامات أكثر تعقيدًا باستخدام
استعلامات فرعية،

2
00:00:04,309 --> 00:00:07,309
قد تبدو مساحة العمل في الفصل الدراسي متكدسة.

3
00:00:07,309 --> 00:00:10,504
إذا لم تكونوا تكتبون استعلاماتكم في محرر،

4
00:00:10,505 --> 00:00:13,950
فقد حان الوقت لتبدؤوا في ذلك. ها هو سير العمل.

5
00:00:13,949 --> 00:00:15,544
يمكنكم أن تروا هنا على اليسار،

6
00:00:15,544 --> 00:00:20,579
لقد فتحت محرري بالامتداد subqueries.sql.

7
00:00:20,579 --> 00:00:23,299
وهنا على اليمين، الفصل الدراسي،

8
00:00:23,300 --> 00:00:26,620
حيث يمكنني قراءة الأسئلة وتنفيذ الكود.

9
00:00:26,620 --> 00:00:29,439
والآن، لنلقِ نظرة على السؤال الأول.

10
00:00:29,439 --> 00:00:32,284
وهو يقول اذكر اسم مندوب المبيعات في

11
00:00:32,284 --> 00:00:36,709
كل منطقة بها أكبر قدر من إجمالي المبيعات بالدولار
الأمريكي.

12
00:00:36,710 --> 00:00:38,579
ولحل هذه المسألة،

13
00:00:38,579 --> 00:00:41,614
لنجرب أولًا سحب بعض المعلومات معًا.

14
00:00:41,615 --> 00:00:45,375
ويمكننا أن نرى أن معلومات مندوب المبيعات موجودة في
هذا الجدول.

15
00:00:45,375 --> 00:00:47,450
ومعلومات المنطقة موجودة هنا،

16
00:00:47,450 --> 00:00:50,780
وإجمالي مبلغ الدولارات الأمريكية هنا في جدول
الطلبات.

17
00:00:50,780 --> 00:00:53,270
ومن ثم، نحتاج إلى ربط هذه الجداول الأربعة

18
00:00:53,270 --> 00:00:56,949
معًا لسحب هذه المعلومات معًا.

19
00:00:56,948 --> 00:00:59,599
حسنًا، لنتابع ونبدأ.

20
00:00:59,600 --> 00:01:30,109
ابدؤوا بتعليق.

21
00:01:30,109 --> 00:01:46,289
حسنًا، يجب أن يسهل هذا

22
00:01:46,290 --> 00:01:49,625
إيجاد هذا الأمر عندما أعود.

23
00:01:49,625 --> 00:01:52,424
فلنبدأ في معالجة هذه المسألة.

24
00:01:52,424 --> 00:01:59,478
حسنًا، نريد جمع هذه المعلومات كلها معًا.

25
00:01:59,478 --> 00:02:05,677
فلنتابع ونبدأ بجدول مندوبي المبيعات.

26
00:02:05,677 --> 00:02:11,312
وسأسمي هذا بالاسم المستعار SR. فلنربط جدول
المنطقة،

27
00:02:11,312 --> 00:02:13,450
وسأسمي هذا بالاسم المستعار R.

28
00:02:13,449 --> 00:02:15,854
نريد أن نربط هذا عند مطابقة المفاتيح الغريبة
والأساسية،

29
00:02:15,854 --> 00:02:24,444
ومن ثم، يبدو هذا كأن معرف منطقة SR يساوي معرف
r.id.

30
00:02:24,444 --> 00:02:29,444
وإذا كنا نريد سحب معلومات الحسابات،

31
00:02:29,444 --> 00:02:38,192
سيكون لديّ الاسم المستعار A ونريد أن يكون معرف مندوب
المبيعات مساويًا لمعرف sr.id.

32
00:02:38,193 --> 00:02:44,950
والآن لنربط جدول الطلبات وسنربط الآن

33
00:02:44,949 --> 00:02:52,457
على معرّف الحساب o مساوٍ لمعرف a.id.

34
00:02:52,457 --> 00:02:57,115
رائع. يبدو أن لدينا الآن جميع المعلومات المسحوبة
معًا.

35
00:02:57,115 --> 00:03:01,000
يمكننا أن نرى من الاستعلام أننا سنحتاج إلى اسم مندوب
المبيعات،

36
00:03:01,000 --> 00:03:06,310
والمنطقة ثم إجمالي مبلغ المبيعات لكلٍ من هؤلاء
المندوبين.

37
00:03:06,310 --> 00:03:09,689
حسنًا، فلنتابع ونسحب بعض هذه المعلومات معًا.

38
00:03:09,689 --> 00:03:13,525
إذًا، إذا سحبنا معلومات مندوب المبيعات،

39
00:03:13,525 --> 00:03:20,760
يمكننا سحب معلومات عن المنطقة،

40
00:03:20,759 --> 00:03:26,992
ثم الطلبات.

41
00:03:26,992 --> 00:03:29,615
نريد إجمالي المبلغ،

42
00:03:29,615 --> 00:03:37,275
ونحتاج إلى ذلك بشكل أساسي لكل مندوب نريده.

43
00:03:37,275 --> 00:03:42,155
مجموع هذا. حسنًا لنقل إن هذا إجمالي المبيعات.

44
00:03:42,155 --> 00:03:47,980
ثم سنحتاج إلى التجميع حسب الأشياء غير الموجودة في
الاسم المستعار.

45
00:03:47,980 --> 00:03:49,590
حسنًا ها هو الاسم المستعار،

46
00:03:49,590 --> 00:03:51,993
ولدينا هذان العمودان الموجودان خارجه.

47
00:03:51,993 --> 00:03:54,014
وسأكتب واحد فاصلة اثنين،

48
00:03:54,014 --> 00:04:02,769
وقد نرتبها من الثالث تنازليًا.

49
00:04:02,770 --> 00:04:04,430
لنتابع ونشغِّل هذا،

50
00:04:04,430 --> 00:04:08,125
انظروا ما سنحصل عليه.

51
00:04:08,125 --> 00:04:10,969
رائع.

52
00:04:10,969 --> 00:04:12,802
إذًا، يبدو أنه تم تنفيذ ذلك.

53
00:04:12,802 --> 00:04:15,514
يمكنكم أن تروا أن لدينا عمود اسم واحد فقط،

54
00:04:15,514 --> 00:04:16,849
وربما يكون هذا بسبب،

55
00:04:16,850 --> 00:04:22,265
اضطراب مساحة العمل بخصوص وجود هذين العمودين اللذين
لهما الاسم ذاته.

56
00:04:22,264 --> 00:04:24,500
إذًا لنكن صرحاء أكثر.

57
00:04:24,500 --> 00:04:30,694
فلنسمِ هذا المندوب، والاسم، والمنطقة.

58
00:04:30,694 --> 00:04:37,298
ولنجرب هذا مجددًا.

59
00:04:37,298 --> 00:04:38,644
رائع.

60
00:04:38,644 --> 00:04:40,475
حسنًا، لدينا الآن ثلاثة أعمدة.

61
00:04:40,475 --> 00:04:43,470
لدينا المندوب والمنطقة وإجمالي المبيعات.

62
00:04:43,470 --> 00:04:44,915
ولكن لهذا السؤال،

63
00:04:44,915 --> 00:04:47,300
نريد توفير اسم مندوب المبيعات في

64
00:04:47,300 --> 00:04:50,210
كل منطقة الذي حقق أكبر قدر من إجمالي المبيعات.

65
00:04:50,209 --> 00:04:54,409
أساسًا ما نريده للمنطقة الجنوبية الشرقية هو أننا
نريد

66
00:04:54,410 --> 00:04:58,737
هذا الفرد وللمنطقة الشمالية الشرقية نريد هذا
الفرد،

67
00:04:58,737 --> 00:04:59,870
ولكن هنا لدينا

68
00:04:59,870 --> 00:05:03,699
شخص آخر من المنطقة الجنوبية الشرقية لا نريده أن يظهر
في جدولنا.

69
00:05:03,699 --> 00:05:05,479
يجب أن يكون هذا الشخص في المنطقة الغربية،

70
00:05:05,480 --> 00:05:11,420
ثم في أي مناطق أخرى أردنا أن يكون فيها ذلك الشخص
بشكل أساسي.

71
00:05:11,420 --> 00:05:17,345
إذًا لنقم بهذا،

72
00:05:17,345 --> 00:05:21,095
سيكون علينا إجراء ربط مخادع،

73
00:05:21,095 --> 00:05:25,360
ولكنه أمر شائع.

74
00:05:25,360 --> 00:05:31,335
في الأساس، لدينا معلومات من هذا الجدول ويعجبنا
ذلك.

75
00:05:31,334 --> 00:05:52,490
إذًا، سننشئ استعلامًا فرعيًا.

76
00:05:52,490 --> 00:05:55,050
سأطلق على هذا اسم t1.

77
00:05:55,050 --> 00:05:58,276
ربما نأتي بمصطلح أفضل لتسمية لذلك.

78
00:05:58,276 --> 00:06:02,039
لكن نريد السحب من t1 ثم في الأساس ما نريد فعله

79
00:06:02,040 --> 00:06:05,110
هو أننا نريد تحديد المنطقة.

80
00:06:05,110 --> 00:06:11,725
حسنًا لا نريد سوى سحب أقصى إجمالي مبيعات لكل
منطقة.

81
00:06:11,725 --> 00:06:21,689
حسنًا، من هذا الجدول الذي شاهدناه للتو، ذلك الموجود
هنا،

82
00:06:21,689 --> 00:06:27,540
سنسحب المنطقة مع أقصى إجمالي مبيعات لتلك المنطقة.

83
00:06:27,540 --> 00:06:31,035
ونظرًا لأن هذا تم تجميعه بالفعل حسب الفرد،

84
00:06:31,035 --> 00:06:34,740
سنحصل على أقصى رقم هنا لكل منطقة.

85
00:06:34,740 --> 00:06:37,650
حسنًا، يجب سحب هذا الرقم للجنوب الشرقي،

86
00:06:37,649 --> 00:06:40,259
ويجب سحب هذا الرقم للشمال الشرقي.

87
00:06:40,259 --> 00:06:41,459
وبالنسبة للغرب،

88
00:06:41,459 --> 00:06:44,324
يجب سحب هذا الرقم وهكذا.

89
00:06:44,324 --> 00:06:46,349
من ثم يمكنكم أن تروا أن لدينا المنطقة الشمالية
الشرقية هذه،

90
00:06:46,350 --> 00:06:48,195
وبالتالي يجب سحب الحد الأقصى هذا،

91
00:06:48,194 --> 00:06:50,500
ويجب أن يختفي كل ما يتبقى.

92
00:06:50,500 --> 00:06:53,670
لسوء الحظ، لا يمكننا إجراء كل هذا مرة واحدة،

93
00:06:53,670 --> 00:06:56,995
لأننا إذا جمعنا حسب الفرد مرة أخرى،

94
00:06:56,995 --> 00:06:59,610
فلا يزال الفرد مع المنطقة

95
00:06:59,610 --> 00:07:03,074
فريدًا وبالتالي سننتهي بجميع هذه القيم في الجدول
مرة أخرى.

96
00:07:03,074 --> 00:07:06,254
ولكن إذا طورنا حسب المنطقة فقط وسحبنا الحد الأقصى،

97
00:07:06,254 --> 00:07:11,153
فيجب علينا فقط الحصول على مندوب واحد مع أقصى قدر من
المبيعات.

98
00:07:11,153 --> 00:07:18,314
حسنًا، هذا ما سنفعله في هذا الجدول.

99
00:07:18,314 --> 00:07:28,480
إذًا، هذا أقصى مبيعات للمنطقة لأن لدينا تجميعًا آخر
في الأعلى هنا،

100
00:07:28,480 --> 00:07:31,569
سنحتاج إلى التجميع حسب أي شيء غير موجود في
التجميع.

101
00:07:31,569 --> 00:07:33,298
إذًا هذا هو الأمر الأول.

102
00:07:33,298 --> 00:07:37,709
حسنًا، لنتابع ونشغِّل هذا مع التأكد من أنه يعمل.

103
00:07:37,910 --> 00:07:43,285
رائع. ما تروه الآن هو أن لدينا هذه المناطق
الأربعة،

104
00:07:43,285 --> 00:07:46,540
وأعتقد أنني قلت أمرًا خطأ عن الشمال الشرقي من قبل.

105
00:07:46,540 --> 00:07:49,194
لدينا هذه المناطق الأربعة في كلٍ منها أقصى مبيعات،

106
00:07:49,194 --> 00:07:53,290
وبالضرورة ما نريد فعله هو أننا نريد مطابقة هذا الجدول
بالجدول الأصلي.

107
00:07:53,290 --> 00:07:55,825
نريد مطابقة ذلك بالجدول الذي كان لدينا من قبل،

108
00:07:55,824 --> 00:07:59,664
حيث تتطابق المناطق وحيث يساوي إجمالي المبيعات

109
00:07:59,665 --> 00:08:02,360
أقصى مبيعات.

110
00:08:02,360 --> 00:08:03,995
إذًا لنتابع ونفعل هذا.

111
00:08:03,995 --> 00:08:06,069
حسنًا، لدينا هذا الجدول،

112
00:08:06,069 --> 00:08:09,964
هذا هو الذي يوجد هنا على اليمين الآن.

113
00:08:09,964 --> 00:08:12,174
حسنًا، سنأخذ هذا،

114
00:08:12,175 --> 00:08:17,912
ومرة أخرى، وسأسميه T2.

115
00:08:17,911 --> 00:08:23,370
إذًا فلنسحب من هذا.

116
00:08:23,370 --> 00:08:28,625
ونريد الربط بهذا الجدول هنا بالأسفل.

117
00:08:28,625 --> 00:08:33,850
حسنًا، سوف نربط على هذا الجدول بالأسفل.

118
00:08:33,850 --> 00:08:37,615
وسيظل هذا مع t3.

119
00:08:37,615 --> 00:08:40,878
إذًا، هذا الجدول الموجود هنا هو t2.

120
00:08:40,878 --> 00:08:43,525
T3 كان الجدول الذي نفذناه من قبل،

121
00:08:43,524 --> 00:08:46,569
ونريد ربطه حيث يساوي أقصى مبيعات

122
00:08:46,570 --> 00:08:49,420
المبيعات التي رأيناها في هذا الجدول السابق،

123
00:08:49,419 --> 00:08:51,219
ثم نسحب المنطقة

124
00:08:51,220 --> 00:08:56,529
والمندوب من الربط.

125
00:08:56,529 --> 00:08:58,129
حسنًا لنحدد.

126
00:08:58,129 --> 00:09:02,004
وبالضرورة لا يهم أين نسحب المنطقة،

127
00:09:02,004 --> 00:09:04,894
أو سواء كنا نسحب أقصى مبيعات أو إجمالي المبيعات.

128
00:09:04,894 --> 00:09:08,053
والجزء المهم هنا حقًا هو جزء الربط.

129
00:09:08,053 --> 00:09:13,029
إذًا، من t2، يمكننا سحب اسم المنطقة،

130
00:09:13,029 --> 00:09:18,750
ومن t2، يمكننا أيضًا سحب أقصى مبيعات،

131
00:09:18,750 --> 00:09:23,576
ثم من t3، نحتاج إلى سحب اسم المندوب.

132
00:09:23,576 --> 00:09:30,240
سأضع هذا أولًا.

133
00:09:30,240 --> 00:09:32,164
حسنًا.

134
00:09:32,164 --> 00:09:35,389
حسنًا، لدينا هنا ثلاثة أجزاء نحتاج إلى سحبها،

135
00:09:35,389 --> 00:09:42,314
ثم الجزء المهم هنا هو كيف نربط هذين الجدولين معًا.

136
00:09:42,315 --> 00:09:45,645
حسنًا، لدينا هذا الجدول بالأعلى هنا الذي يحتوي على
اسم المنطقة،

137
00:09:45,644 --> 00:09:50,615
وأقصى مبيعات لمندوب معين،

138
00:09:50,615 --> 00:09:54,086
وما نريد فعله بالضرورة الآن هو أننا نريد ربط هذا.

139
00:09:54,086 --> 00:10:02,694
حسنًا، نريد الربط عند اسم المنطقة يساوي اسم المنطقة
الأخرى.

140
00:10:02,695 --> 00:10:10,004
ونريد أن يكون أقصى مبيعات في t2

141
00:10:10,004 --> 00:10:18,033
مساويًا لإجمالي المبيعات في t3.

142
00:10:18,033 --> 00:10:23,200
حسنًا، إذا كانت المناطق متطابقة فإننا نعرف أننا
نتفحص المنطقة الصحيحة.

143
00:10:23,200 --> 00:10:25,645
وإذا كان أقصى مبيعات مساويًا لإجمالي المبيعات،

144
00:10:25,644 --> 00:10:29,350
هذا يعني أن أقصى مبيعات يساوي

145
00:10:29,350 --> 00:10:34,284
المبيعات التي رأيناها لمندوب معين في الجدول الأول.

146
00:10:34,284 --> 00:10:37,360
حسنًا، لن يسحب ذلك إلا

147
00:10:37,360 --> 00:10:43,705
مندوبي المبيعات الذين لديهم مبيعات مساوية لهذه
المبالغ،

148
00:10:43,705 --> 00:10:45,810
وتكون موجودة في هذه المنطقة.

149
00:10:45,809 --> 00:10:49,689
حسنًا، كما ترون يوجد في الشمال الشرقي أعلى قدر من
المبيعات.

150
00:10:49,690 --> 00:10:52,790
إذًا، قد يكون هناك شخص في الشمال الشرقي قد حقق هذه
المبيعات.

151
00:10:52,789 --> 00:10:55,314
وإذا لم نطابق هذه المنطقة هنا،

152
00:10:55,315 --> 00:11:01,453
فمن المحتمل أن يكون هناك تعدد مع أقصى مبيعات لدينا
في الغرب الأوسط،

153
00:11:01,452 --> 00:11:03,366
ولكن ليس الحد الأقصى لتلك المنطقة،

154
00:11:03,366 --> 00:11:04,704
فإن هذا هو الحد الأقصى لتلك المنطقة.

155
00:11:04,705 --> 00:11:08,960
إذًا، يمكننا المطابقة على المنطقة وكمية المبيعات.

156
00:11:08,960 --> 00:11:15,556
رائع. فلنتابع ونشغّل ذلك.

157
00:11:15,556 --> 00:11:18,759
حسنًا.

158
00:11:18,759 --> 00:11:21,480
حسنًا، يبدو أن لدينا أربع نتائج.

159
00:11:21,480 --> 00:11:23,700
لدينا المنطقة الشمالية الشرقية، والجنوبية الشرقية،

160
00:11:23,700 --> 00:11:24,855
والغربية، والغربية الوسطى،

161
00:11:24,855 --> 00:11:25,980
ولا يظهر أي شيء آخر هناك.

162
00:11:25,980 --> 00:11:27,500
حسنًا توجد تلك المناطق الأربعة.

163
00:11:27,500 --> 00:11:30,029
وهذا بالضرورة أقصى كمية للمبيعات

164
00:11:30,029 --> 00:11:33,789
حسب مندوب معين ثم اسم ذلك المندوب.

